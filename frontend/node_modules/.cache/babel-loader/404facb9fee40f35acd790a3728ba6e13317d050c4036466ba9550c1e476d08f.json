{"ast":null,"code":"import React,{useState,useEffect}from'react';import{connectSocket}from'../services/socket';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Chat(_ref){let{gameId}=_ref;// REÇOIT gameId\nconst[msgs,setMsgs]=useState([]);const[text,setText]=useState('');const[socket,setSocket]=useState(null);// Pour stocker la socket\nuseEffect(()=>{const newSocket=connectSocket(gameId);// UTILISE gameId\nnewSocket.onmessage=e=>setMsgs(msgs=>[...msgs,JSON.parse(e.data)]);setSocket(newSocket);// Stocke la socket\nreturn()=>{// Fonction de nettoyage\nif(newSocket.readyState===WebSocket.OPEN){newSocket.close();}};},[gameId]);// Reconnecte si gameId change\nconst send=()=>{if(socket&&socket.readyState===WebSocket.OPEN){socket.send(JSON.stringify({type:'chat',message:text,game_id:gameId}));// ENVOIE LE MESSAGE AVEC game_id\nsetText('');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2\",children:\"Chat\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"h-40 overflow-auto border p-2\",children:[msgs.map((m,i)=>/*#__PURE__*/_jsx(\"p\",{children:m.message},i)),\" \"]}),/*#__PURE__*/_jsx(\"input\",{value:text,onChange:e=>setText(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:send,children:\"Envoyer\"})]});}","map":{"version":3,"names":["React","useState","useEffect","connectSocket","jsx","_jsx","jsxs","_jsxs","Chat","_ref","gameId","msgs","setMsgs","text","setText","socket","setSocket","newSocket","onmessage","e","JSON","parse","data","readyState","WebSocket","OPEN","close","send","stringify","type","message","game_id","className","children","map","m","i","value","onChange","target","onClick"],"sources":["C:/Users/charl/complot/frontend/src/components/Chat.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { connectSocket } from '../services/socket'\r\n\r\nexport default function Chat({ gameId }) { // REÇOIT gameId\r\n  const [msgs, setMsgs] = useState([])\r\n  const [text, setText] = useState('')\r\n  const [socket, setSocket] = useState(null); // Pour stocker la socket\r\n\r\n  useEffect(() => {\r\n    const newSocket = connectSocket(gameId) // UTILISE gameId\r\n    newSocket.onmessage = e => setMsgs(msgs => [...msgs, JSON.parse(e.data)])\r\n    setSocket(newSocket); // Stocke la socket\r\n\r\n    return () => { // Fonction de nettoyage\r\n      if (newSocket.readyState === WebSocket.OPEN) {\r\n        newSocket.close();\r\n      }\r\n    };\r\n  }, [gameId]) // Reconnecte si gameId change\r\n\r\n  const send = () => {\r\n    if (socket && socket.readyState === WebSocket.OPEN) {\r\n      socket.send(JSON.stringify({ type: 'chat', message: text, game_id: gameId })); // ENVOIE LE MESSAGE AVEC game_id\r\n      setText('');\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-4\">\r\n      <h3 className=\"font-semibold mb-2\">Chat</h3>\r\n      <div className=\"h-40 overflow-auto border p-2\">\r\n        {msgs.map((m,i) => <p key={i}>{m.message}</p>)} {/* Affiche le contenu du message */}\r\n      </div>\r\n      <input value={text} onChange={e=>setText(e.target.value)} />\r\n      <button onClick={send}>Envoyer</button>\r\n    </div>\r\n  )\r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,aAAa,KAAQ,oBAAoB,QAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAElD,cAAe,SAAS,CAAAC,IAAIA,CAAAC,IAAA,CAAa,IAAZ,CAAEC,MAAO,CAAC,CAAAD,IAAA,CAAI;AACzC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACY,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACc,MAAM,CAAEC,SAAS,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAAE;AAE5CC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAe,SAAS,CAAGd,aAAa,CAACO,MAAM,CAAC,CAAC;AACxCO,SAAS,CAACC,SAAS,CAAGC,CAAC,EAAIP,OAAO,CAACD,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAES,IAAI,CAACC,KAAK,CAACF,CAAC,CAACG,IAAI,CAAC,CAAC,CAAC,CACzEN,SAAS,CAACC,SAAS,CAAC,CAAE;AAEtB,MAAO,IAAM,CAAE;AACb,GAAIA,SAAS,CAACM,UAAU,GAAKC,SAAS,CAACC,IAAI,CAAE,CAC3CR,SAAS,CAACS,KAAK,CAAC,CAAC,CACnB,CACF,CAAC,CACH,CAAC,CAAE,CAAChB,MAAM,CAAC,CAAC,CAAC;AAEb,KAAM,CAAAiB,IAAI,CAAGA,CAAA,GAAM,CACjB,GAAIZ,MAAM,EAAIA,MAAM,CAACQ,UAAU,GAAKC,SAAS,CAACC,IAAI,CAAE,CAClDV,MAAM,CAACY,IAAI,CAACP,IAAI,CAACQ,SAAS,CAAC,CAAEC,IAAI,CAAE,MAAM,CAAEC,OAAO,CAAEjB,IAAI,CAAEkB,OAAO,CAAErB,MAAO,CAAC,CAAC,CAAC,CAAE;AAC/EI,OAAO,CAAC,EAAE,CAAC,CACb,CACF,CAAC,CAED,mBACEP,KAAA,QAAKyB,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnB5B,IAAA,OAAI2B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,MAAI,CAAI,CAAC,cAC5C1B,KAAA,QAAKyB,SAAS,CAAC,+BAA+B,CAAAC,QAAA,EAC3CtB,IAAI,CAACuB,GAAG,CAAC,CAACC,CAAC,CAACC,CAAC,gBAAK/B,IAAA,MAAA4B,QAAA,CAAYE,CAAC,CAACL,OAAO,EAAbM,CAAiB,CAAC,CAAC,CAAC,GAAC,EAC7C,CAAC,cACN/B,IAAA,UAAOgC,KAAK,CAAExB,IAAK,CAACyB,QAAQ,CAAEnB,CAAC,EAAEL,OAAO,CAACK,CAAC,CAACoB,MAAM,CAACF,KAAK,CAAE,CAAE,CAAC,cAC5DhC,IAAA,WAAQmC,OAAO,CAAEb,IAAK,CAAAM,QAAA,CAAC,SAAO,CAAQ,CAAC,EACpC,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}